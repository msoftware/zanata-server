<ui:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:a4j="http://richfaces.org/a4j">


  <script type="text/javascript">
    function confirmDelete() {
      return confirm("#{messages['jsf.AreYouSureYouWishToRemoveThisPersonAsGroupMaintainer']}");
    }

    function showAddMaintainer() {
      #{rich:component('maintainerAddPanel')}
    .
      show();
      #{rich:element('input')}
    .
      focus();
    }
  </script>

  <a href="#" class="action_link"
    onclick="#{rich:component('maintainerAddPanel')}.show()">#{messages['jsf.AddGroupMaintainer']}</a>

  <s:fragment
    rendered="#{s:hasPermission(versionGroupMaintainerAction.group, 'update')}">
    <h:messages/>
    <rich:dataTable id="threads" value="#{maintainerList}" var="maintainer">
      <rich:column>
        <f:facet name="header">#{messages['jsf.Username']}</f:facet>
        #{maintainer.account.username}
      </rich:column>
      <rich:column>
        <f:facet name="header">#{messages['jsf.Name']}</f:facet>
        #{maintainer.name}
      </rich:column>
      <rich:column>
        <f:facet name="header">#{messages['jsf.Email']}</f:facet>
        #{maintainer.email}
      </rich:column>
      <rich:column styleClass="txt--align-center">
        <f:facet name="header">#{messages['jsf.Actions']}</f:facet>
        <h:commandButton value="#{messages['jsf.Remove']}"
          action="#{versionGroupMaintainerAction.deleteMaintainer(versionGroupMaintainerAction.selectedPerson)}"
          onclick="return confirmDelete()"/>
      </rich:column>
    </rich:dataTable>
  </s:fragment>

  <s:fragment
    rendered="#{s:hasPermission(versionGroupMaintainerAction.group, 'update')}">
    <rich:popupPanel id="maintainerAddPanel" width="505" autosized="true"
      moveable="false">
      <f:facet name="header">
        <h:outputText value="#{messages['jsf.AddGroupMaintainer']}"/>
      </f:facet>
      <h:form>
        <ui:include src="../WEB-INF/layout/add_maintainer_form.xhtml"/>

        <div style="clear: both"/>

        <a4j:commandButton
          value="#{messages['jsf.Add']}"
          action="#{versionGroupMaintainerAction.addMaintainers(accountSearch.maintainer)}"
          render="results, threads" styleClass="button--primary"
          type="button"/>
        <h:commandButton value="#{messages['jsf.Close']}"
          onclick="#{rich:component('maintainerAddPanel')}.hide(); return false;"/>
      </h:form>
    </rich:popupPanel>
  </s:fragment>

</ui:composition>
