<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:zanata="http://java.sun.com/jsf/composite/zanata"
  template="../WEB-INF/template/template.xhtml">

  <ui:define name="page_title">
    #{messages['jsf.Groups']}:#{versionGroupHomeAction.instance.name}
  </ui:define>


  <ui:define name="center_content">
    <script type="text/javascript">
      jQuery(document).ready(function () {
        renderStatistics();
      });

      function toggleActiveTab(tabId) {
        jQuery("[id^=tab-]").removeClass('is-active');
        jQuery('#' + tabId).addClass('is-active');
      }
    </script>

    <h:form>
      <a4j:jsFunction name="renderStatistics"
        render="overall_statistic, language_list"
        action="#{versionGroupHomeAction.setPageRendered(true)}"/>

      <a4j:jsFunction name="selectTab" render="tabs_content">
        <a4j:param name="selectedView"
          assignTo="#{versionGroupHomeAction.view}"/>
      </a4j:jsFunction>
    </h:form>

    <div class="g">
      <div class="g__item w--1-2-m w--3-8-l w--1-3 l--push-bottom-1">
        <p class="txt--meta l--push-all-0">
          <s:link view="/version-group/home.xhtml" propagation="none">
            #{messages['jsf.Groups']}
          </s:link>
        </p>

        <div class="media l--push-bottom-half">
          <div class="media__body">
            <h1 class="l--push-all-0">
              #{versionGroupHomeAction.instance.name}
            </h1>

            <p class="txt--understated">
              #{versionGroupHomeAction.instance.description}
            </p>
          </div>
        </div>

        <a4j:outputPanel id="overall_statistic">
          <s:fragment rendered="#{versionGroupHomeAction.pageRendered}">
            <p class="d--top l--pad-top-half txt--mini">
              #{messages['jsf.TotalSourceContains']}
              <strong>#{versionGroupHomeAction.getOverallStatistic().getTotalWordCount()} words / #{versionGroupHomeAction.getOverallStatistic().getTotalMessageCount()} messages</strong>
            </p>
            <ul class="g g--fit">
              <li class="g__item">
                <span class="stats--large txt--state-success">
                  <span class="stats__figure">
                    #{statisticBar.formatPercentage(versionGroupHomeAction.getOverallStatistic().statistic.percentTranslated)}%
                  </span>
                  <span class="stats__unit txt--lowercase">
                    #{messages['jsf.stats.Translated']}
                  </span>
                </span>
              </li>
              <li class="g__item">
                <span class="stats--large">
                  <span class="stats__figure">
                    #{statisticBar.formatHours(versionGroupHomeAction.getOverallStatistic().statistic.remainingHours)}
                  </span>
                  <span class="stats__unit">
                    #{messages['jsf.stats.TotalHoursRemaining']}
                  </span>
                </span>
              </li>
            </ul>
            <div class="progress-bar__expander l--push-v-1">
              <zanata:statistic
                value="#{versionGroupHomeAction.getOverallStatistic().statistic}"
                type="large"/>
            </div>
          </s:fragment>
          <zanata:loader type="large"
            rendered="#{!versionGroupHomeAction.pageRendered}"/>
        </a4j:outputPanel>
      </div>


      <div class="g__item w--1-2-m w--5-8-l w--2-3">
        <div class="tabs--lined">
          <nav class="tabs__nav">
            <ul>
              <li>
                <a4j:commandLink
                  onclick="toggleActiveTab(this.id);selectTab(this.id)"
                  id="tab-languages"
                  styleClass="#{versionGroupHomeAction.view eq component.id ? 'is-active' : ''}">
                  <i class="i i--language"></i>
                  <span class="is-hidden--m-down">
                    #{messages['jsf.Languages']}
                  </span>
                  <span class="txt--neutral">
                    #{versionGroupHomeAction.activeLocales.size}
                  </span>
                </a4j:commandLink>
              </li>
              <li>
                <a4j:commandLink
                  onclick="toggleActiveTab(this.id);selectTab(this.id)"
                  id="tab-projects"
                  styleClass="#{versionGroupHomeAction.view eq component.id ? 'is-active' : ''}">
                  <i class="i i--project"></i>
                  <span class="is-hidden--m-down">
                    #{messages['jsf.Projects']}
                  </span>
                  <span class="txt--neutral">
                    #{versionGroupHomeAction.projectIterations.size}
                  </span>
                </a4j:commandLink>
              </li>
              <li>
                <a4j:commandLink
                  onclick="toggleActiveTab(this.id);selectTab(this.id)"
                  id="tab-maintainers"
                  styleClass="#{versionGroupHomeAction.view eq component.id ? 'is-active' : ''}">
                  <i class="i i--users"></i>
                  <span class="is-hidden--m-down">
                    #{messages['jsf.Maintainers']}
                  </span>
                  <span class="txt--neutral">
                    #{versionGroupHomeAction.instance.maintainers.size}
                  </span>
                </a4j:commandLink>
              </li>
              <li>
                <a4j:commandLink
                  onclick="toggleActiveTab(this.id);selectTab(this.id)"
                  id="tab-settings"
                  styleClass="#{versionGroupHomeAction.view eq component.id ? 'is-active' : ''}">
                  <i class="i i--settings"></i>
                  <span class="is-hidden--m-down">
                    #{messages['jsf.Settings']}
                  </span>
                </a4j:commandLink>
              </li>
            </ul>
          </nav>

          <s:div styleClass="tabs__content panels__container l--push-top-1"
            id="tabs_content">
            <s:div
              style="#{versionGroupHomeAction.view eq 'tab-languages' ? 'display: initial' : 'display:none'}">
              <ui:include
                src="../WEB-INF/layout/version-group/languages-tab.xhtml">
              </ui:include>
            </s:div>

            <s:div
              style="#{versionGroupHomeAction.view eq 'tab-projects' ? 'display: initial' : 'display:none'}">
              <ui:include
                src="../WEB-INF/layout/version-group/projects-tab.xhtml"/>
            </s:div>

            <s:div
              style="#{versionGroupHomeAction.view eq 'tab-maintainers' ? 'display: initial' : 'display:none'}">
              <ui:include
                src="../WEB-INF/layout/version-group/maintainers-tab.xhtml"/>
            </s:div>

            <s:div
              style="#{versionGroupHomeAction.view eq 'tab-settings' ? 'display: initial' : 'display:none'}">
              <ui:include
                src="../WEB-INF/layout/version-group/settings-tab.xhtml"/>
            </s:div>
          </s:div>
        </div>
      </div>
    </div>

    <s:link styleClass="action_link" view="/version-group/request_to_join.xhtml"
      value="#{messages['jsf.RequestToJoinVersionGroup']}" propagation="none"
      rendered="#{versionGroupHomeAction.isUserProjectMaintainer()}">
      <f:param name="emailType" value="request_to_join_group"/>
      <f:param name="versionGroupSlug"
        value="#{versionGroupHomeAction.instance.slug}"/>
    </s:link>
  </ui:define>

</ui:composition>
